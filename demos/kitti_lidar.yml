# -----------------------------------------------------------------------------
#                        SLAM system definition for MOLA
# This file defines:
# a 3D LiDAR-SLAM problem, fed from a Kitti dataset.
# -----------------------------------------------------------------------------

modules:
# Setup of SLAM back-end =====================================
  - name: backend
    type: RSLAM_gtsam
    execution_rate: 100 # Hz
    verbosity_level: INFO
    params:
      # Built-up of the state vector of the system
      state_vector:
        # Keyframe dynamic state:
        keyframe_state_type: Pose3D
        # Other dynamic variables (one per timestep)
        dynamic:
          # None
        # Static/Global variables (one value for all timesteps)
        static:
          # None
          # camera intrinsics?
      # List of sensor models:
      sensors:
        # Relative poses from 3D Lidar Sensor
        - name: RelPosesLidar
          type: RelativePose3D
          input_front_end: lidar_fe
# Setup of SLAM front-ends ====================================
  - name: lidar_fe
    type: LidarICP
    raw_data_source: kitti_input
    raw_sensor_label: lidar
    params:
# Offline or online sensory data sources =====================
# TODO: Create a YAML !include
  - name: kitti_input
    type: KittiOdometryDataset
    execution_rate: 50 # Hz
    verbosity_level: INFO
    gui_preview_sensors:
      - raw_sensor_label: lidar
        decimation: 1
    params:
      base_dir: ${KITTI_BASE_DIR}
      sequence: 00
      time_warp_scale: 1.0
      publish_lidar: true
      publish_image_0: false
      publish_image_1: false
